<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <title id="title">lan-code-api</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="format-detection" content="telephone=no">
    <link rel="stylesheet" type="text/css"
          th:href="@{/layui/css/layui.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/global.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/jquery.json-viewer.css}">
</head>
<body>
<div id="body">

</div>
</body>
<div th:include="common/common.html"></div>
<div th:include="menu/switchTemplate.html"></div>
<div th:include="menu/menuTemplate.html"></div>
<script th:src="@{/js/jquery.js}"></script>
<script th:src="@{/js/jsrender.min.js}"></script>
<script th:src="@{/js/jquery.json-viewer.js}"></script>
<script th:src="@{/js/menu/menu.js}"></script>
<script th:src="@{/js/project/project.js}"></script>
<script th:src="@{/js/env/env.js}"></script>
<script type="text/javascript">
    let projectData;
    let envData;
    let currProject = getCurrProject();
    let currProjectData = getCurrProject();
    $(function () {
        getEnvAll(data => envData = data)
        projectAll(data => {
            projectData = data;

            if (currProject == null) {
                currProjectData = {
                    project: projectData[0],
                    branch: projectData[0].branchList[0],
                    env: envData[0],
                }
                currProject = setCurrProject(currProjectData.project.id, currProjectData.branch.id, currProjectData.env.id);
            } else {
                let project = projectData.find(i => i.id === currProject.projectId);
                let branch = project.branchList.find(i => i.id === currProject.branchId);
                let env = envData.find(i => i.id === currProject.envId);
                currProjectData = {
                    project: project,
                    branch: branch,
                    env: env,
                }
            }
            //显示菜单
            viewMenu(currProjectData.branch.id);

        })

    })
</script>

</html>

